---
description: >-
  Prevent attackers from manipulating redirects and forwards to bypass access
  controls, deliver malicious payloads, or trick users.
---

# 422.44 Invalid forwarding and redirecting

### Overview

Invalid forwarding and redirecting occur when an application redirects or forwards a user to another page without validating the destination. Attackers can exploit this by crafting links that appear legitimate but lead users to untrusted or dangerous locations, or even gain access to restricted areas of a system.

These flaws are often overlooked because redirects and forwards are standard features in login workflows, post-submission pages, and internal navigation. When misused, they can lead to phishing, privilege escalation, and session hijacking.

### Targets

In this topic, students learn to:

* Explain how unvalidated redirects and forwards create vulnerabilities
* Identify common scenarios where redirects or forwards are used in software
* Implement secure checks before performing any redirect or forward
* Validate all user-supplied URLs and destinations

### Syllabus references

<details>

<summary><a href="https://curriculum.nsw.edu.au/learning-areas/tas/software-engineering-11-12-2022/content/year-12/fa039e749d">Secure software architecture</a></summary>

**Developing secure code**

* Design, develop and implement secure code to minimise vulnerabilities in user action controls, including:\
  –  invalid forwarding and redirecting

</details>

### What is an invalid redirect?

Redirects send users from one URL to another. If an attacker can control the destination URL, they can trick users into visiting a fake or malicious site that looks trustworthy.

**Example:**

```
https://example.com/redirect?to=http://evil.com
```

If the redirect logic doesn’t check the `to` parameter, the user is sent to a phishing site with no warning.

### What is an invalid forward?

Forwards transfer control internally to another part of the application (e.g. a different page or resource). If input isn’t validated, attackers may access restricted files or bypass security checks.

**Example (pseudocode):**

```
forward(request.get("page"))
```

An attacker could request `admin.jsp` when only standard users should see `home.jsp`.

### Consequences of exploitation

* **Phishing attacks** – Users are tricked into entering credentials on lookalike pages
* **Access control bypass** – Attackers access internal resources not intended for them
* **Malware delivery** – Users are redirected to download malicious code
* **Brand impersonation** – Users believe they are on the original site and act accordingly

### How to prevent this vulnerability

#### 1. Avoid using user-controlled input for redirects or forwards

Whenever possible, do not let users determine the destination URL. Use fixed server-side logic for redirects.

#### 2. Whitelist allowed destinations

If redirecting is required, use a whitelist to ensure only trusted destinations are allowed.

**Example (Python pseudocode):**

```python
ALLOWED_URLS = ["https://example.com/dashboard", "https://example.com/logout"]

if url in ALLOWED_URLS:
    redirect(url)
else:
    error("Invalid destination")
```

#### 3. Validate and normalise input

If input is used, ensure it is:

* Encoded
* Stripped of dangerous characters
* Matched against known-safe paths

#### 4. Add a warning or confirmation

Before redirecting to an external site, inform the user and request confirmation.

### Summary

* Invalid forwarding and redirecting allow attackers to trick users or bypass system controls
* Never redirect based on unvalidated user input
* Use allowlists, input validation, and user warnings to reduce risk
* Secure systems must maintain control over navigation and access transitions
