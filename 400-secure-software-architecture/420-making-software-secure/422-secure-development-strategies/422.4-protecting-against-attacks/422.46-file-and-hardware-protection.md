---
description: >-
  Protect user data and physical devices by controlling how files are accessed,
  stored, and handled during execution.
---

# 422.46 File and hardware protection

### Overview

Software that handles files or interacts with physical devices must be written with care. Unvalidated file input, insecure file storage, or unauthorised hardware access can lead to serious security breaches. Similarly, hardware attacks—known as side channel attacks—can reveal sensitive information by observing how software interacts with the underlying system.

This topic focuses on how developers can reduce these risks through secure file handling and defensive coding patterns that limit exposure to hardware-based vulnerabilities.

### Targets

In this topic, students learn to:

* Identify common file and hardware vulnerabilities
* Apply safe file handling and access controls in code
* Design programs that minimise exposure to physical attack vectors
* Understand the risks of side channel attacks and how to prevent them

### Syllabus references

{% include "../../../../.gitbook/includes/untitled.md" %}

### File attacks

These attacks involve exploiting how software opens, reads, writes, or stores files. They often occur when:

* A file path is not validated and attackers access unintended directories
* File uploads are accepted without checking content or file type
* Temporary files are stored insecurely or with weak permissions
* Sensitive files (e.g. configs, logs, keys) are exposed via public paths

#### Prevention techniques

* **Validate file paths and extensions:** Only allow specific, expected formats.
* **Restrict directory traversal:** Avoid `../` patterns that escape intended folders.
* **Limit file permissions:** Apply least privilege to files (e.g. read-only, user-only).
* **Sanitise filenames:** Remove dangerous characters and enforce naming rules.
* **Store sensitive files outside the web root** in web apps.
* **Use secure temporary storage** for intermediate files.

#### Example (Python):

```python
import os

UPLOAD_DIR = "/secure/uploads/"
filename = os.path.basename(user_input_filename)

if filename.endswith(".jpg") or filename.endswith(".png"):
    with open(os.path.join(UPLOAD_DIR, filename), "wb") as f:
        f.write(file_content)
else:
    raise ValueError("Unsupported file type")
```

This code prevents path traversal and limits uploads to safe image types.

### Side channel attacks

Side channel attacks exploit **indirect signals** produced by a program’s execution. These include:

* **Timing** – Measuring how long an operation takes to infer data (e.g. password length)
* **Power consumption** – Observing CPU load to detect sensitive operations
* **Electromagnetic signals** – Using nearby devices to detect activity
* **Cache behaviour** – Monitoring CPU cache to infer access patterns

These attacks are particularly relevant in embedded systems, smart devices, or low-level firmware environments.

#### Prevention techniques

* **Use constant-time operations** for cryptographic comparisons
* **Avoid conditional branches based on sensitive data**
* **Introduce random delays** to mask patterns
* **Limit physical access** to the device where feasible
* **Use hardware with built-in protection** (e.g. TPM, Secure Enclave)

### Summary

* File attacks exploit poor input validation, insecure file storage, or weak access controls
* Always validate file names, types, and paths before processing
* Side channel attacks observe physical signals to extract data—especially in embedded or cryptographic systems
* Defensive programming and secure configuration help protect both software and hardware assets
