---
description: >-
  Protect software from two of the most common web-based attacks by validating
  input, managing sessions, and restricting unauthorised commands.
---

# 422.41 XSS and CSRF

### Overview

Cross-site scripting (XSS) and cross-site request forgery (CSRF) are two common and dangerous web-based attacks. They exploit the relationship between a user, their browser, and a trusted web application. Both rely on tricking users into performing unintended actions or injecting malicious code into otherwise trusted systems.

This topic explores how these attacks work and what developers can do to prevent them through careful coding and secure configuration.

### Targets

In this topic, students learn to:

* Explain how XSS and CSRF attacks exploit web applications
* Identify scenarios where user input or session handling is vulnerable
* Apply secure development techniques to prevent XSS and CSRF
* Evaluate how cookies, tokens, and input validation improve web security

### Syllabus references

<details>

<summary><a href="https://curriculum.nsw.edu.au/learning-areas/tas/software-engineering-11-12-2022/content/year-12/fa039e749d">Secure software architecture</a></summary>

**Developing secure code**

* Design, develop and implement secure code to minimise vulnerabilities in user action controls, including:\
  –  cross-site scripting (XSS) and cross-site request forgery (CSRF)

</details>

### What is XSS (Cross-site scripting)?

XSS occurs when an attacker injects malicious scripts (usually JavaScript) into a web page viewed by other users. It happens when user input is not properly validated or escaped before being displayed.

#### Example:

```html
<input name="comment" value="<script>alert('Hacked!')</script>">
```

This would execute JavaScript in the browser of anyone viewing the page.

#### Types of XSS:

* Stored XSS: The malicious script is saved in a database or file and served to multiple users
* Reflected XSS: The script appears in a URL or form and is immediately reflected back
* DOM-based XSS: Manipulates the document structure using unsafe JavaScript APIs

#### Prevention:

* Encode all user input before displaying it in the browser
* Sanitize rich text or HTML using trusted libraries
* Use Content Security Policy (CSP) headers
* Avoid using innerHTML or eval() with dynamic input

### What is CSRF (Cross-site request forgery)?

CSRF tricks a logged-in user into submitting a request they didn’t intend, usually by clicking a link or loading a page that sends a hidden request on their behalf. If the user is authenticated, the attacker’s request appears valid.

#### Example:

A malicious email or website includes

```html
<img src="https://bank.com/transfer?to=attacker&amount=1000">
```

If the user is logged into their bank, the browser will send the request with valid cookies.

#### Prevention:

* Use anti-CSRF tokens (unique per form/session) and verify them on the server
* Set cookies with SameSite=Strict to prevent them being sent on cross-site requests
* Require re-authentication or verification for sensitive actions
* Block GET requests from performing actions that change data

### Key differences

| **Feature**  | **XSS**                         | **CSRF**                           |
| ------------ | ------------------------------- | ---------------------------------- |
| Targets      | End users                       | Web application                    |
| Exploits     | Displaying unescaped user input | Trust in the user’s authentication |
| Prevent with | Output encoding, CSP            | CSRF tokens, SameSite cookies      |

### Summary

* XSS allows attackers to inject scripts into pages viewed by other users
* CSRF tricks authenticated users into sending malicious requests
* Both attacks can be prevented by validating input, managing sessions properly, and using secure defaults
* Secure development must account for how users interact with pages, forms, and browser behaviour
