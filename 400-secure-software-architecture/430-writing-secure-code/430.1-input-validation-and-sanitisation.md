---
description: >-
  Learn how to validate and sanitise user input to protect your software from
  crashes, corrupted data, and attacks like code injection.
---

# 430.1 Input validation and sanitisation

### Objectives

* Explain the importance of input validation and sanitisation in secure coding
* Identify techniques that prevent unauthorised or dangerous input
* Apply secure coding patterns to reduce the risk of injection and other common threats

### Syllabus references

<details>

<summary><a href="https://curriculum.nsw.edu.au/learning-areas/tas/software-engineering-11-12-2022/content/year-12/fa039e749d">Secure software architecture</a></summary>

* Design, develop and implement code using defensive data input handling practices, including:\
  – input validation\
  – sanitisation\
  – error handling

</details>

### What is input validation?

**Input validation** is the process of checking that all input your program receives is correct, expected, and safe. This includes data from:

* Forms and user interfaces
* URLs and query strings
* Cookies and session variables
* Files, APIs, and databases

Input that is not checked correctly can lead to serious security vulnerabilities — including **code injection**, **XSS**, and **data corruption**.

#### Key principle: Never trust user input

Always assume that any input could be:

* Incorrect (e.g. a letter where a number is expected)
* Malicious (e.g. trying to inject JavaScript or SQL code)
* Unexpected (e.g. too long, missing, or out of range)

### Validation vs sanitisation

| **Validation**                         | **Sanitisation**                               |
| -------------------------------------- | ---------------------------------------------- |
| Confirms input is correct and safe     | Cleans input to remove harmful elements        |
| Used to reject bad input early         | Used when input must be accepted but made safe |
| Example: Must be a number between 1–10 | Example: Strip tags from a comment field       |

Both are important — but **validate first**, and only sanitise if necessary.

### Safe input validation strategies

#### 1. Whitelist (allow only known good input)

Reject everything except exactly what is expected.

✅ **Good:**

```python
if age in range(13, 100):
    register_user()
```

❌ **Avoid:**

```python
if not "DROP" in input_text:
    run_query(input_text)  # Too broad
```

#### 2. Use built-in validation functions

Where possible, use trusted libraries or frameworks that provide built-in validation support (e.g., regular expressions, form validators, schema validators).

#### 3. Validate all fields — even hidden ones

Don’t assume that dropdowns, hidden fields, or cookies are safe. Attackers can change them.

### Common validation mistakes

* **Relying only on client-side validation** (JavaScript can be bypassed)
* **Failing to check length or format** of strings (e.g. unlimited length usernames)
* **Allowing unchecked file uploads** (e.g. accepting `.exe`, `.php`, or very large files)
* **Assuming numeric input is safe** (e.g. entering `0 OR 1=1` into a login form)

### Example: Python form validation

```python
def validate_age(age):
    if not age.isdigit():
        return False
    age_int = int(age)
    return 13 <= age_int <= 120
```

This function ensures that the age is a numeric value and falls within a reasonable range.

### Summary

* Input validation checks that data is correct, expected, and safe before using it
* Sanitisation cleans input when rejection is not possible
* Never trust user input — validate everything, server-side
* Good input validation prevents common vulnerabilities like code injection and corrupted data
